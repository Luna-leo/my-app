# サンプリング一貫性テスト手順

## 問題の背景
以前は、同一データを複数のチャートに表示した際、異なるサンプリング結果になることがありました。これは`Object.keys()`の非決定論的な動作により、異なるパラメータがサンプリング基準として選ばれるためでした。

## 修正内容
1. `sampleTimeSeriesData`関数に`samplingParameter`引数を追加
2. ChartDataContextで最初のY軸パラメータをサンプリング基準として使用
3. パラメータが指定されない場合はアルファベット順でソート

## テスト手順

### 1. 同一データの複数表示テスト
1. 大きなデータセット（5,000点以上）を選択
2. 同じデータで2つ以上のチャートを作成
3. 各チャートのSampledバッジが表示されることを確認
4. チャートの形状が完全に一致することを確認

### 2. 異なるY軸パラメータ順序テスト
1. 複数のパラメータを持つデータセットを選択
2. Y軸パラメータの順序を変えて複数のチャートを作成
   - チャート1: [パラメータA, パラメータB]
   - チャート2: [パラメータB, パラメータA]
3. 各チャートでサンプリングされる点が一貫していることを確認

### 3. キャッシュ一貫性テスト
1. チャートを作成
2. ページをリロード
3. 同じチャートを再作成
4. サンプリング結果が同一であることを確認

## 期待される結果
- 同一データ・同一設定のチャートは常に同じサンプリング結果になる
- Y軸パラメータの最初のものが常にサンプリング基準として使用される
- キャッシュからのデータも一貫性を保つ

## デバッグ方法
ブラウザのコンソールで以下のログを確認：
- `Time series sampled: X → Y points`
- サンプリングに使用されたパラメータ名（今後追加予定）